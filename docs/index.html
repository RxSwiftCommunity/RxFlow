<!DOCTYPE html>
<html lang="en">
  <head>
    <title>RxFlow  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="RxFlow  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">RxFlow Docs</a> (94% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">RxFlow Reference</a>
        <img id="carat" src="img/carat.png" />
        RxFlow  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/CompositeStepper.html">CompositeStepper</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DefaultStepper.html">DefaultStepper</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/FlowContributor.html">FlowContributor</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/FlowCoordinator.html">FlowCoordinator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Flows.html">Flows</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/OneStepper.html">OneStepper</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/FlowContributors.html">FlowContributors</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RxFlowStep.html">RxFlowStep</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/ObservableType.html">ObservableType</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Reactive.html">Reactive</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Flow.html">Flow</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Presentable.html">Presentable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols.html#/s:6RxFlow4StepP">Step</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Stepper.html">Stepper</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols.html#/s:6RxFlow14SynchronizableP">Synchronizable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6RxFlow11Coordinatora">Coordinator</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6RxFlow04NextB4Itema">NextFlowItem</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6RxFlow04NextB5Itemsa">NextFlowItems</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <table><thead>
<tr>
<th><img alt="RxFlow Logo" src="https://raw.githubusercontent.com/RxSwiftCommunity/RxFlow/develop/Resources/RxFlow_logo.png" width="250"/></th>
<th><ul align="left"><li><a href="#about">About</a><li><a href="#navigation-concerns">Navigation concerns</a><li><a href="#rxflow-aims-to">RxFlow aims to</a><li><a href="#installation">Installation</a><li><a href="#the-core-principles">The core principles</a><li><a href="#how-to-use-rxflow">How to use RxFlow</a><li><a href="#tools-and-dependencies">Tools and dependencies</a></ul></th>
</tr>
</thead><tbody>
<tr>
<td>Travis CI</td>
<td><a href="https://travis-ci.org/RxSwiftCommunity/RxFlow"><img src="https://travis-ci.org/RxSwiftCommunity/RxFlow.svg?branch=develop" alt="Build Status"></a></td>
</tr>
<tr>
<td>Frameworks</td>
<td><a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage Compatible"></a> <a href="http://cocoapods.org/pods/RxFlow"><img src="https://img.shields.io/cocoapods/v/RxFlow.svg?style=flat" alt="CocoaPods Compatible"></a></td>
</tr>
<tr>
<td>Platform</td>
<td><a href="http://cocoapods.org/pods/RxFlow"><img src="https://img.shields.io/cocoapods/p/RxFlow.svg?style=flat" alt="Platform"></a></td>
</tr>
<tr>
<td>Licence</td>
<td><a href="http://cocoapods.org/pods/RxFlow"><img src="https://img.shields.io/cocoapods/l/RxFlow.svg?style=flat" alt="License"></a></td>
</tr>
</tbody></table>

<p><span style="float:none" /></p>
<h1 id='about' class='heading'>About</h1>

<p>RxFlow is a navigation framework for iOS applications based on a Flow Coordinator pattern.</p>

<p>This README is a short story of the whole conception process that led me to this framework.</p>

<p>You will find a very detail explanation of the whole project on my blog:</p>

<ul>
<li><a href="https://twittemb.github.io/swift/coordinator/rxswift/rxflow/reactive%20programming/2017/11/08/rxflow-part-1-in-theory/">RxFlow Part 1: In Theory</a></li>
<li><a href="https://twittemb.github.io/swift/coordinator/reactive/rxflow/reactive%20programming/2017/12/09/rxflow-part-2-in-practice/">RxFlow Part 2: In Practice</a></li>
<li><a href="https://twittemb.github.io/swift/coordinator/reactive/rxswift/reactive%20programming/rxflow/2017/12/22/rxflow-part-3-tips-and-tricks/">RxFlow Part 3: Tips and Tricks</a></li>
</ul>

<p>The Jazzy documentation can be seen here as well: <a href="http://community.rxswift.org/RxFlow/">Documentation</a></p>
<h1 id='migrating-from-v1-0-x-to-v1-1-0' class='heading'>Migrating from v1.0.x to v1.1.0</h1>

<p>There are two major changes that must be taken care of if you want to use the v1.1.0 when coming from an older version:</p>

<ul>
<li><strong>Flowable</strong> has been replaced by <strong>NextFlowItem</strong>. It&rsquo;s exactly the same idea between those 2 names, but <q>Flowable</q> was too much related to a Protocol naming convention. The <strong>Flow.navigate(to:)</strong> function has to return a <strong>NextFlowItems</strong>, which is an enum that represents different possibilities of NextFlowItem (multiple, one, none, &hellip;). Take a look at the code snippets below to see some examples.</li>
<li>In order to improve RxFlow consistency, it seemed obvious that a Flow that presents a UIViewController also <strong>HAS</strong> to dismiss it. In previous versions, a child Flow was dismissed by itself and not by the Flow that presented it. In the Demo Application you will find an example with the WishlistFlow dismissing the SettingsFlow for the <strong>settingsDone</strong> Step.</li>
</ul>
<h1 id='migrating-from-v1-x-x-to-v1-3-0' class='heading'>Migrating from v1.x.x to v1.3.0</h1>

<p>There are two major changes that must be taken care of if you want to use the v1.3.0 when coming from an older version:</p>

<ul>
<li><strong>NextFlowItems.stepNotHandled</strong> has been removed for the sake of simplicity. If you want a received step to have no effect at all in a <strong>navigate(to:)</strong> function, all you need to do is returning a <strong>NextFlowItems.none</strong> value. It means that no new <strong>Stepper</strong> will be registered in the Coordinator.</li>
<li><strong>NextFlowItems.end(withStepForParentFlow: Step)</strong> allows to explicitly tell the Coordinator that you want to dismiss the current Flow. You can pass the Step you want the parent Flow to receive in its <strong>navigate(to:)</strong> function. That is where you will dismiss the child Flow root <strong>Presentable</strong>. It can be also used to pass data to the parent **
Flow** thanks to an enum parameter (withStepForParentFlow could be something like: DemoStep.loginIsComplete(idUser: xxx))</li>
</ul>

<p>The DemoApp has been updated to implement those changes. It shows how to swap between 2 Flows attached to the root Window.</p>
<h1 id='navigation-concerns' class='heading'>Navigation concerns</h1>

<p>Regarding navigation within an iOS application, two choices are available:</p>

<ul>
<li>Use the builtin mechanism provided by Apple and Xcode: storyboards and segues</li>
<li>Implement a custom mechanism directly in the code</li>
</ul>

<p>The disadvantage of these two solutions:</p>

<ul>
<li>Builtin mechanism: navigation is relatively static and the storyboards are massive. The navigation code pollutes the UIViewControllers</li>
<li>Custom mechanism: code can be difficult to set up and can be complex depending on the chosen design pattern (Router, Coordinator)</li>
</ul>
<h1 id='rxflow-aims-to' class='heading'>RxFlow aims to</h1>

<ul>
<li>Promote the cutting of storyboards into atomic units to enable collaboration and reusability of UIViewControllers</li>
<li>Allow the presentation of a UIViewController in different ways according to the navigation context</li>
<li>Ease the implementation of dependency injection</li>
<li>Remove every navigation mechanism from UIViewControllers</li>
<li>Promote reactive programming</li>
<li>Express the navigation in a declarative way while addressing the majority of the navigation cases</li>
<li>Facilitate the cutting of an application into logical blocks of navigation</li>
</ul>
<h1 id='installation' class='heading'>Installation</h1>
<h2 id='carthage' class='heading'>Carthage</h2>

<p>In your Cartfile:</p>
<pre class="highlight ruby"><code><span class="n">github</span> <span class="s2">"RxSwiftCommunity/RxFlow"</span>
</code></pre>
<h2 id='cocoapods' class='heading'>CocoaPods</h2>

<p>In your Podfile:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'RxFlow'</span>
</code></pre>
<h1 id='the-key-principles' class='heading'>The key principles</h1>

<p>The <strong>Coordinator</strong> pattern is a great way to organize the navigation within your application. It allows to:</p>

<ul>
<li>remove the navigation code from UIViewControllers</li>
<li>reuse UIViewControllers in different navigation contexts</li>
<li>ease the use of dependency injection</li>
</ul>

<p>To learn more about it, I suggest you take a look at this article: (<a href="http://khanlou.com/2015/10/coordinators-redux/">Coordinator Redux</a>).</p>

<p>To me, the Coordinator pattern has some drawbacks:</p>

<ul>
<li>you have to write the coordination mechanism each time you bootstrap an application</li>
<li>there can be a lot of boilerplate code because of the delegation pattern that allows to communicate with Coordinators</li>
</ul>

<p>RxFlow is a reactive implementation of the Coordinator pattern. It has all the great features of this architecture, but introduces some improvements:</p>

<ul>
<li>makes the navigation more declarative</li>
<li>provides a built-in Coordinator that handles the navigation flows you&rsquo;ve declared</li>
<li>uses reactive programming to address the communication with Coordinators issue</li>
</ul>

<p>There are 6 terms you have to be familiar with to understand <strong>RxFlow</strong>:</p>

<ul>
<li><strong>Flow</strong>: each <strong>Flow</strong> defines a navigation area within your application. This is the place where you declare the navigation actions (such as presenting a UIViewController or another Flow)</li>
<li><strong>Step</strong>: each <strong>Step</strong> is a navigation state in your application. Combinations of <strong>Flows</strong> and <strong>Steps</strong> describe all the possible navigation actions. A <strong>Step</strong> can even embed inner values (such as Ids, URLs, &hellip;) that will be propagated to screens declared in the <strong>Flows</strong></li>
<li><strong>Stepper</strong>: it can be anything that can emit <strong>Steps</strong>. <strong>Steppers</strong> will be responsible for triggering every navigation actions within the <strong>Flows</strong></li>
<li><strong>Presentable</strong>: it is an abstraction of something that can be presented (basically <strong>UIViewController</strong> and <strong>Flow</strong> are <strong>Presentable</strong>). <strong>Presentables</strong> offer Reactive observables that the <strong>Coordinator</strong> will subscribe to in order to handle <strong>Flow Steps</strong> in a UIKit compliant way</li>
<li><strong>NextFlowItem</strong>: it is a simple data structure that combines a <strong>Presentable</strong> and a <strong>Stepper</strong>. It tells the <strong>Coordinator</strong> what will be the next thing that will produce new <strong>Steps</strong> in your Reactive mechanism</li>
<li><strong>Coordinator</strong>: once the developer has defined the suitable combinations of <strong>Flows</strong> and <strong>Steps</strong> representing the navigation possibilities, the job of the <strong>Coordinator</strong> is to mix these combinations in a consistent way.</li>
</ul>
<h1 id='how-to-use-rxflow' class='heading'>How to use RxFlow</h1>
<h2 id='code-samples' class='heading'>Code samples</h2>
<h3 id='how-to-declare-strong-steps-strong' class='heading'>How to declare <strong>Steps</strong></h3>

<p>As <strong>Steps</strong> are seen like some navigation states spread across the application, it seems pretty obvious to use an enum to declare them</p>
<pre class="highlight swift"><code><span class="kd">enum</span> <span class="kt">DemoStep</span><span class="p">:</span> <span class="kt">Step</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">apiKey</span>
    <span class="k">case</span> <span class="n">apiKeyIsComplete</span>

    <span class="k">case</span> <span class="n">movieList</span>

    <span class="k">case</span> <span class="nf">moviePicked</span> <span class="p">(</span><span class="nv">withMovieId</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span>
    <span class="k">case</span> <span class="nf">castPicked</span> <span class="p">(</span><span class="nv">withCastId</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span>

    <span class="k">case</span> <span class="n">settings</span>
    <span class="k">case</span> <span class="n">settingsDone</span>
    <span class="k">case</span> <span class="n">about</span>
<span class="p">}</span>
</code></pre>
<h3 id='how-to-declare-a-strong-flow-strong' class='heading'>How to declare a <strong>Flow</strong></h3>

<p>The following <strong>Flow</strong> is used as a Navigation stack. All you have to do is:</p>

<ul>
<li>declare a root UIViewController on which your navigation will be based</li>
<li>implement the <strong>navigate(to:)</strong> function to transform a <strong>Step</strong> into a navigation action</li>
</ul>

<p>The <strong>navigate(to:)</strong> function returns a <strong>NextFlowItems</strong>. This is how the next navigation actions will be produced (the <strong>Stepper</strong> defined in a <strong>NextFlowItem</strong> will emit the next <strong>Steps</strong>)</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">WatchedFlow</span><span class="p">:</span> <span class="kt">Flow</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">root</span><span class="p">:</span> <span class="kt">Presentable</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="n">rootViewController</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">rootViewController</span> <span class="o">=</span> <span class="kt">UINavigationController</span><span class="p">()</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">service</span><span class="p">:</span> <span class="kt">MoviesService</span>

    <span class="nf">init</span><span class="p">(</span><span class="n">withService</span> <span class="nv">service</span><span class="p">:</span> <span class="kt">MoviesService</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="n">service</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">navigate</span><span class="p">(</span><span class="n">to</span> <span class="nv">step</span><span class="p">:</span> <span class="kt">Step</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">NextFlowItems</span> <span class="p">{</span>

        <span class="k">guard</span> <span class="k">let</span> <span class="nv">step</span> <span class="o">=</span> <span class="n">step</span> <span class="k">as?</span> <span class="kt">DemoStep</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">NextFlowItems</span><span class="o">.</span><span class="k">none</span> <span class="p">}</span>

        <span class="k">switch</span> <span class="n">step</span> <span class="p">{</span>

        <span class="k">case</span> <span class="o">.</span><span class="nv">movieList</span><span class="p">:</span>
            <span class="k">return</span> <span class="nf">navigateToMovieListScreen</span><span class="p">()</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">moviePicked</span><span class="p">(</span><span class="k">let</span> <span class="nv">movieId</span><span class="p">):</span>
            <span class="k">return</span> <span class="nf">navigateToMovieDetailScreen</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">movieId</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">castPicked</span><span class="p">(</span><span class="k">let</span> <span class="nv">castId</span><span class="p">):</span>
            <span class="k">return</span> <span class="nf">navigateToCastDetailScreen</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">castId</span><span class="p">)</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="kt">NextFlowItems</span><span class="o">.</span><span class="k">none</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">navigateToMovieListScreen</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">NextFlowItems</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">WatchedViewModel</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">service</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">WatchedViewController</span><span class="o">.</span><span class="nf">instantiate</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">viewModel</span><span class="p">)</span>
        <span class="n">viewController</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Watched"</span>
        <span class="k">self</span><span class="o">.</span><span class="n">rootViewController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="k">return</span> <span class="kt">NextFlowItems</span><span class="o">.</span><span class="nf">one</span><span class="p">(</span><span class="nv">flowItem</span><span class="p">:</span> <span class="kt">NextFlowItem</span><span class="p">(</span><span class="nv">nextPresentable</span><span class="p">:</span> <span class="n">viewController</span><span class="p">,</span> <span class="nv">nextStepper</span><span class="p">:</span> <span class="n">viewModel</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">navigateToMovieDetailScreen</span> <span class="p">(</span><span class="n">with</span> <span class="nv">movieId</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">NextFlowItems</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">MovieDetailViewModel</span><span class="p">(</span><span class="nv">withService</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">service</span><span class="p">,</span> <span class="nv">andMovieId</span><span class="p">:</span> <span class="n">movieId</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">MovieDetailViewController</span><span class="o">.</span><span class="nf">instantiate</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">viewModel</span><span class="p">)</span>
        <span class="n">viewController</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">rootViewController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="k">return</span> <span class="kt">NextFlowItems</span><span class="o">.</span><span class="nf">one</span><span class="p">(</span><span class="nv">flowItem</span><span class="p">:</span> <span class="kt">NextFlowItem</span><span class="p">(</span><span class="nv">nextPresentable</span><span class="p">:</span> <span class="n">viewController</span><span class="p">,</span> <span class="nv">nextStepper</span><span class="p">:</span> <span class="n">viewModel</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">navigateToCastDetailScreen</span> <span class="p">(</span><span class="n">with</span> <span class="nv">castId</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">NextFlowItems</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">CastDetailViewModel</span><span class="p">(</span><span class="nv">withService</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">service</span><span class="p">,</span> <span class="nv">andCastId</span><span class="p">:</span> <span class="n">castId</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">CastDetailViewController</span><span class="o">.</span><span class="nf">instantiate</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">viewModel</span><span class="p">)</span>
        <span class="n">viewController</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">name</span>
        <span class="k">self</span><span class="o">.</span><span class="n">rootViewController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
        <span class="k">return</span> <span class="kt">NextFlowItems</span><span class="o">.</span><span class="k">none</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='how-to-declare-a-strong-stepper-strong' class='heading'>How to declare a <strong>Stepper</strong></h3>

<p>In theory a <strong>Stepper</strong>, as it is a protocol, can be anything (a UIViewController for instance) by I suggest to isolate that behavior in a ViewModel or so.
For simple cases (for instance when we only need to bootstrap a <strong>Flow</strong> with a first <strong>Step</strong> and don&rsquo;t want to code a basic <strong>Stepper</strong> for that), RxFlow provides a <strong>OneStepper</strong> class.</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">WatchedViewModel</span><span class="p">:</span> <span class="kt">Stepper</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">movies</span><span class="p">:</span> <span class="p">[</span><span class="kt">MovieViewModel</span><span class="p">]</span>

    <span class="nf">init</span><span class="p">(</span><span class="n">with</span> <span class="nv">service</span><span class="p">:</span> <span class="kt">MoviesService</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// we can do some data refactoring in order to display things exactly the way we want (this is the aim of a ViewModel)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">movies</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="nf">watchedMovies</span><span class="p">()</span><span class="o">.</span><span class="nf">map</span><span class="p">({</span> <span class="p">(</span><span class="n">movie</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">MovieViewModel</span> <span class="k">in</span>
            <span class="k">return</span> <span class="kt">MovieViewModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">movie</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="n">movie</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="nv">image</span><span class="p">:</span> <span class="n">movie</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="c1">// when a movie is picked, a new Step is emitted.</span>
    <span class="c1">// That will trigger a navigation action within the WatchedFlow</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">pick</span> <span class="p">(</span><span class="nv">movieId</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="kt">DemoStep</span><span class="o">.</span><span class="nf">moviePicked</span><span class="p">(</span><span class="nv">withMovieId</span><span class="p">:</span> <span class="n">movieId</span><span class="p">))</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>
<h3 id='is-it-possible-to-coordinate-multiple-flows' class='heading'>Is it possible to coordinate multiple Flows ?</h3>

<p>Of course, it is the aim of a Coordinator. As a Flow is a Presentable, a Flow can launch one other Flow or even several other Flows.</p>

<p>For instance, from the WishlistFlow, we launch the SettingsFlow in a popup.</p>
<pre class="highlight swift"><code><span class="kd">private</span> <span class="kd">func</span> <span class="nf">navigateToSettings</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">NextFlowItems</span> <span class="p">{</span>     
    <span class="k">let</span> <span class="nv">settingsStepper</span> <span class="o">=</span> <span class="kt">SettingsStepper</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">settingsFlow</span> <span class="o">=</span> <span class="kt">SettingsFlow</span><span class="p">(</span><span class="nv">withService</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">service</span><span class="p">,</span> <span class="nv">andStepper</span><span class="p">:</span> <span class="n">settingsStepper</span><span class="p">)</span>
    <span class="kt">Flows</span><span class="o">.</span><span class="nf">whenReady</span><span class="p">(</span><span class="nv">flow1</span><span class="p">:</span> <span class="n">settingsFlow</span><span class="p">,</span> <span class="nv">block</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="p">(</span><span class="nv">root</span><span class="p">:</span> <span class="kt">UISplitViewController</span><span class="p">)</span> <span class="k">in</span>
        <span class="k">self</span><span class="o">.</span><span class="n">rootViewController</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="kt">NextFlowItems</span><span class="o">.</span><span class="nf">one</span><span class="p">(</span><span class="nv">flowItem</span><span class="p">:</span> <span class="kt">NextFlowItem</span><span class="p">(</span><span class="nv">nextPresentable</span><span class="p">:</span> <span class="n">settingsFlow</span><span class="p">,</span> <span class="nv">nextStepper</span><span class="p">:</span> <span class="n">settingsStepper</span><span class="p">))</span>
<span class="p">}</span>
</code></pre>

<p>For a more complex case, see the <strong>MainFlow.swift</strong> file in which we handle a UITabBarController.</p>
<h3 id='how-to-bootstrap-the-rxflow-process' class='heading'>How to bootstrap the RxFlow process</h3>

<p>The coordination process is pretty straightfoward and happens in the AppDelegate.</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">AppDelegate</span><span class="p">:</span> <span class="kt">UIResponder</span><span class="p">,</span> <span class="kt">UIApplicationDelegate</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span>
    <span class="k">var</span> <span class="nv">window</span><span class="p">:</span> <span class="kt">UIWindow</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">coordinator</span> <span class="o">=</span> <span class="kt">Coordinator</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">movieService</span> <span class="o">=</span> <span class="kt">MoviesService</span><span class="p">()</span>
    <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">appFlow</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">AppFlow</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">movieService</span><span class="p">)</span>
    <span class="p">}()</span>

    <span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>
                     <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplicationLaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>

        <span class="k">guard</span> <span class="k">let</span> <span class="nv">window</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">window</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">false</span> <span class="p">}</span>

        <span class="c1">// listen for Coordinator mechanism is not mandatory</span>
        <span class="n">coordinator</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">didNavigate</span><span class="o">.</span><span class="nf">subscribe</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="k">in</span>
            <span class="nf">print</span> <span class="p">(</span><span class="s">"did navigate to flow=</span><span class="se">\(</span><span class="n">flow</span><span class="se">)</span><span class="s"> and step=</span><span class="se">\(</span><span class="n">step</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">})</span><span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">disposeBag</span><span class="p">)</span>

        <span class="c1">// when the MainFlow is ready to be displayed, we assign its root the the Window</span>
        <span class="kt">Flows</span><span class="o">.</span><span class="nf">whenReady</span><span class="p">(</span><span class="nv">flow1</span><span class="p">:</span> <span class="n">appFlow</span><span class="p">,</span> <span class="nv">block</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="n">window</span><span class="p">]</span> <span class="p">(</span><span class="n">flowRoot</span><span class="p">)</span> <span class="k">in</span>
            <span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="n">flowRoot</span>
        <span class="p">})</span>

        <span class="c1">// The navigation begins with the MainFlow at the apiKey Step</span>
        <span class="c1">// We could also have a specific Stepper that could decide if</span>
        <span class="c1">// the apiKey should be the fist step or not</span>
        <span class="n">coordinator</span><span class="o">.</span><span class="nf">coordinate</span><span class="p">(</span><span class="nv">flow</span><span class="p">:</span> <span class="n">appFlow</span><span class="p">,</span> <span class="nv">withStepper</span><span class="p">:</span> <span class="kt">OneStepper</span><span class="p">(</span><span class="nv">withSingleStep</span><span class="p">:</span> <span class="kt">DemoStep</span><span class="o">.</span><span class="n">apiKey</span><span class="p">))</span>

        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>As a bonus, <strong>Coordinator</strong> offers a Rx extension that allows you to track the navigation actions (Coordinator.rx.willNavigate and Coordinator.rx.didNavigate).</p>
<h2 id='demo-application' class='heading'>Demo Application</h2>

<p>A demo application is provided to illustrate the core mechanisms. Pretty much every kind of navigation is addressed. The app consists of:</p>

<ul>
<li>an AppFlow that represents the main navigation. This Flow will handle the OnboardingFlow and the DashboardFlow</li>
<li>an OnBoardingFlow that represents a 2 steps onboarding wizard in a UINavigationController. It will only be displayed the first time the app is used</li>
<li>a DashboardFlow that handles the Tabbar for the WishlistFlow and the WatchedFlow</li>
<li>a WishlistFlow that represents a navigation stack of movies that you want to watch</li>
<li>a WatchedFlow that represents a navigation stack of movies that you&rsquo;ve already seen</li>
<li>a SettingsFlow that represents the user&rsquo;s preferences in a master/detail presentation</li>
</ul>

<p><br/>
<kbd>
<img style="border:2px solid black" alt="Demo Application" src="https://raw.githubusercontent.com/RxSwiftCommunity/RxFlow/develop/Resources/RxFlow.gif"/>
</kbd></p>
<h1 id='tools-and-dependencies' class='heading'>Tools and dependencies</h1>

<p>RxFlow relies on:</p>

<ul>
<li>SwiftLint for static code analysis (<a href="https://github.com/realm/SwiftLint">Github SwiftLint</a>)</li>
<li>RxSwift to expose Steps as Observables the Coordinator can react to (<a href="https://github.com/ReactiveX/RxSwift">Github RxSwift</a>)</li>
<li>Reusable in the Demo App to ease the storyboard cutting into atomic ViewControllers (<a href="https://github.com/AliSoftware/Reusable">Github Reusable</a>)</li>
</ul>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2018 <a class="link" href="https://github.com/RxSwiftCommunity/RxFlow" target="_blank" rel="external">Thibault Wittemberg and RxSwiftCommunity</a>. All rights reserved. (Last updated: 2018-12-29)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
